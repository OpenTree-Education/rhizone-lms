import { Meta } from '@storybook/addon-docs';

<Meta title="Guides/Adding features" />

# Adding features

Every property in the YAML and Markdown files in the `src/content` directory is
a feature of the website. That data is sent into React components to modify
their behaviour and display content. Following is the process for adding a new
property that adds a feature to the app.

## Example feature

The example feature that will be added is the ability to add a meta description
to pages. The property `description` will be added to pages and then used to add
a `<meta name="description" ... />` tag to the `<head>` of the page.

### 1. Add the new property to a page

In order for Gatsby to be able to query for the new property, it must exist on
at least one page. The following line will be added to the `index.yml` page.

```yaml
...
description: |
  OpenTree Education offers a Professional Mentorship Program to help people
  from diverse jumpstart their tech careers.
...
```

## 2. Query for the new property

Once the property exists in at least one page, it can be queried in the
`gatsby-node.js` file. Locate the relevant GraphQL query in the file and add the
name of the new property to the query.

```graphql
...
query ListPages {
  allPagesYaml {
    nodes {
      description
...
```

To experiment with the query before modifying the file, run the development
server and go to the GraphiQL Playground at `/___graphql` and try running the
modified query.

## 3. Document the property in the TypeScript data type

Now that the data is being passed into the React app, adding it to the
TypeScript data type will make the React components aware of it.

Edit the `src/types/content.d.ts` file by adding the new property to the
appropriate interface (in alphabetical order) along with documentation that will
appear on this documentation website.

```typescript
...
export interface PageData {
  ...
  /**
   * SEO description for this page. Search engines may use this content for
   * ranking search results, and it may appear to users in snippets.
   */
  description?: string;
  ...
}
...
```

Note that the property is marked as optional by using the question mark (`?`).
If a required property is desired, a value should be added for it to all pages
before moving on to the next step.

## 4. Use the new data in the React component

The React component that this property is used in is the `Page` component.
Finally, the `description` property can be received in the props for the
component and used in the render function.

```tsx
...
export const Page = ({
  background,
  description,
  sections,
  title,
}: PageData) => (
  <>
    <Helmet>
      <title>{title}</title>
      {description && <meta name="description" content={description} />}
    </Helmet>
...
```

In this case, since the property is optional, a `<meta>` tag is only added if
there is a truthy value in the `description` prop.
